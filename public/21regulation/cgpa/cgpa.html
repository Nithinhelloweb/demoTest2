<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>CGPA Calculator</title>
    <!-- <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        label { display: block; margin-top: 10px; }
        table { margin-top: 20px; border-collapse: collapse; }
        th, td { padding: 8px 15px; border: 1px solid #ccc; text-align: center; }
        button { margin-top: 20px; }
        #result { margin-top: 30px; font-weight: bold; }
        .delete-btn { background: #d9534f; color: #fff; border: none; cursor: pointer; padding: 5px 10px; border-radius: 3px; }
        .delete-btn:hover { background: #b52b27; }
    </style> -->
    <link rel="stylesheet" href="/21regulation/cgpa/cgpa.css">
</head>
<body>
    <header>
        <img src="/images/logo.png" alt="LOGO" class="logo">
        <p class="header-text"><b>SRI SHAKTHI INSTITUTE OF ENGINEERING AND TECHNOLOGY</b></p>
        <img src="/images/Naac logo" alt="Naac" class="logo">
    </header>
  <nav>
    <div id="datecal">
      <a href="/Departments/cse/csechoose.html"><img src="/images/back.png" id="back" alt="Back"/></a>
      <a href="/home.html"><img src="/images/home.png" id="home" alt="Home"/></a>
      <p id="date" class="date"></p><br><br>
    </div>
    <h3>CGPA Calculator</h3>
    <form id="cgpaForm">
        <table id="semesterTable">
            <thead>
                <tr>
                    <th>Semester</th>
                    <th>SGPA</th>
                    <th>Credits</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td><input type="number" step="0.01" min="0" max="10" name="sgpa1" required></td>
                    <td><input type="number" step="1" min="1" name="credits1" required></td>
                    <td></td>
                </tr>
            </tbody>
        </table>
        <button type="button" onclick="addSemester()">Add Semester</button>
        <button type="submit">Calculate CGPA</button>
    </form>
    <center>
        <div id="result"></div>
    </center>
    <footer>
        <p>Help desk.siet.ac.in</p>
    </footer>
    <script>
        const options = { day: '2-digit', month: 'long', year: 'numeric' };
        document.getElementById("date").innerText = new Date().toLocaleDateString("en-GB", options);

        let semesterCount = 1;

        function addSemester() {
            if (semesterCount >= 8) {
              alert("You can only add up to 8 semesters.");
              return;
            }
            semesterCount++;
            const table = document.getElementById('semesterTable').getElementsByTagName('tbody')[0];
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td>${semesterCount}</td>
                <td><input type="number" step="0.01" min="0" max="10" name="sgpa${semesterCount}" required></td>
                <td><input type="number" step="1" min="1" name="credits${semesterCount}" required></td>
                <td><button type="button" class="delete-btn" onclick="deleteSemester(this)">Delete</button></td>
            `;
            table.appendChild(newRow);
            renumberSemesters();
        }

        function deleteSemester(button) {
            const row = button.closest('tr');
            row.parentNode.removeChild(row);
            renumberSemesters();
        }

        function renumberSemesters() {
            const rows = document.querySelectorAll('#semesterTable tbody tr');
            semesterCount = rows.length;
            rows.forEach((row, idx) => {
                row.cells[0].innerText = idx + 1;
                // Rename the input names accordingly
                row.querySelectorAll('input').forEach(input => {
                    if(input.name.startsWith('sgpa')) input.name = `sgpa${idx+1}`;
                    else if(input.name.startsWith('credits')) input.name = `credits${idx+1}`;
                });
            });
        }

        document.getElementById('cgpaForm').onsubmit = function(event) {
            event.preventDefault();
            let totalWeightedSGPA = 0;
            let totalCredits = 0;
            let validInput = true;
            const rows = document.querySelectorAll('#semesterTable tbody tr');
            rows.forEach((row, idx) => {
                const sgpaInput = row.querySelector(`input[name="sgpa${idx+1}"]`);
                const creditsInput = row.querySelector(`input[name="credits${idx+1}"]`);
                const sgpa = parseFloat(sgpaInput.value);
                const credits = parseInt(creditsInput.value);
                if (isNaN(sgpa) || isNaN(credits)) validInput = false;
                totalWeightedSGPA += sgpa * credits;
                totalCredits += credits;
            });
            if (!validInput || totalCredits === 0) {
                document.getElementById('result').textContent = "Please enter all values correctly.";
                return;
            }
            const cgpa = (totalWeightedSGPA / totalCredits).toFixed(2);
            document.getElementById('result').textContent = "Your CGPA is : " + cgpa;
        };
    </script>
</body>
</html>
